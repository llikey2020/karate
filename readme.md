# Karate Testing Framework Documentation

## Background

Karate is an open-source API testing framework that runs with Java. The syntax for the framework makes testing very
easy even for people not very familiar with the Java programming language (more about this later). No code needs to be compiled, however
you will need a basic understanding of JSON in order to efficiently use this framework.

---

## Set Up

In order to set up Karate you will need an IDE supports Java. Eclipse is very popular, however this specific packaging of the framework
was created and used with Visual Studio Code.

Here are some prerequisites needed to run the framework:

- Visual Studio Code
- Apache Maven 3.8.5
- Java Development Kit (JDK) version 11.0.13

You will also want to install these VSCode extension to simplify user experience

- Cucumber (Gherkin) Full Support
- Karate Runner
- Maven for Java
- Language Support for Java

---

### Getting Maven installed

- First, ensure that JDK is already installed by running 'java -version' in Windows Command Prompt.
- Run 'mvn -verion' in Windows Command Prompt to see if Maven may be already installed properly
- Configure the JAVA_HOME env variable 
- Unzip the Maven download and place in a folder (usually under the C:\Program Files)
- Add MAVEN_HOME to your system variables
- You can do this by pressing the Windows button and typing "View advanced system settings" -> "Environment Variables"
- Under "System Variables" -> "New" and set the name to "MAVEN_HOME" and the value to the Maven file path.

---

### Project Set Up

Navigate to desired directory in Windows Command Prompt and type

> mvn archetype:generate -DgroupId=com.mygroupid.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false

This should create a Maven project. Then open the pom.xml to add the following dependancies:

- Karate Core
- Karate Apache
- Karate JUnit 4

These can be found at the [Maven Repository](https://mvnrepository.com)

Then run the command 'mvn clean install'. Add this to your pom.xml if you run into a "Source option X is no longer supported":

>  <properties>
>    <maven.compiler.source>1.6</maven.compiler.source>
>    <maven.compiler.target>1.6</maven.compiler.target>
>  </properties>

---

## Creating Test Cases

Under the src/test/... will be where all the main files for testing will be created. You can go ahead and remove everything in the .java file
that is already present and replace it with

> package com.sequoiadb;
>
> import org.junit.runner.RunWith;
> import com.intuit.karate.junit4.Karate;
> 
> @RunWith(Karate.class)
> public class BatchJobTest {
>   
> }

You won't need to add anything else to this .java file.
The main file extension for Karate is .feature file. This is what Cucumber, the framework Karate is built upon, uses. It makes use of the
Gherkin syntax which is almost like English making it very easy to learn and to use. Some keywords that are important are:

- Feature (Description of the test file)
- Scenario (Description of the test case)
- Given
- When
- Then
- And

Here is an example API test case written in the feature file:

> Feature: Sample Test
>
> Scenario: Testing a GET API
>     Given url 'https://www.sampleapi.com'
>     And path 'getnames'
>     When method GET
>     Then status 200
>     And print response

This sample test case will query the sampleapi.com/getnames endpoint and will expect to receive a 200 status code and then print the response body. You can add multiple scenarios in a single feature file and can even set global variables to make the typing less redundant. You can
also make use of the 'match' keyword which is an assertion statement to ensure the response bodies contain expected values.

Refering to the official documentation on [GitHub](https://github.com/karatelabs/karate) is the best way to learn about all the various features
and keywords.

You can also reuse a generic .feature file as a template to make creating test cases more modular. Refer to "Calling Other Feature Files" and "Data Driven Features" to learn how to properly use these features.

---

## Running the Tests

On VSCode with all the recommended extensions installed, you can simply run all Scenarios in all .feature files by navigating to the .java file and clicking the red dot next to 'public class'. You can also run each scenario individually by clicking 'Karate Run' on top of every Scenario keyword, generated by the Karate Runner extension.

You can also run the command 'mvn test' or 'mvn clean test'

After succesfully running a test, a folder called "karate-reports" will be generated under the "target" directory. Open up the summary.html to view the results of the test cases. You can expand a few sections to view more details about the test case.